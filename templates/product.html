<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>{{ product['Title'] }} | Amazon Product Detail</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { background:#eef2f7;}
        .brand-bar { background: linear-gradient(90deg, #e94d2a 0%, #ff9000 70%);
            color: #fff; padding: 1rem 0; margin-bottom: 30px; box-shadow: 0 2px 8px #e94d2a33;}
        .product-img { border-radius:14px; box-shadow:0 2px 18px #eee; width:95%; max-width:340px;}
        .details { background:#fff; border-radius:18px; box-shadow:0 2px 20px #ffc75a33;}
    </style>
</head>
<body>
    <div class="brand-bar text-center mb-4">
        <h1>Amazon Product Recommendation</h1>
    </div>
    <div class="container">
        <div class="details row p-4 mb-4 align-items-center">
            <div class="col-md-5 text-center">
                <img src="{{ product['Image URL'] }}" alt="Product Image" class="product-img">
            </div>
            <div class="col-md-7">
                <h2>{{ product['Title'] }}</h2>
                <h4 class="mb-3 text-warning">₹{{ product['Price (INR)'] }}</h4>
                <p><span class="text-secondary">Category:</span> <span class="text-dark fw-bold">{{ product['Category'] }}</span></p>
                {% if product['Description'] %}
                <p class="mt-2"><span class="fw-bold">Description:</span> {{ product['Description'] }}</p>
                {% endif %}
                <a href="{{ product['Product Link'] }}" class="btn amazon-btn btn-lg mt-3" target="_blank">
                    Buy on Amazon
                </a>
            </div>
        </div>
        <a href="{{ url_for('home') }}" class="btn amazon-btn">Go Home</a>
        <footer class="text-muted mt-4 small text-center opacity-75">
            &copy; {{2025}} <span style="color:#e94d2a">Amazon Product Recommender</span>
        </footer>
    </div>
    <script>
        document.addEventListener("DOMContentLoaded", () => {
        const btn = document.getElementById("goHomeBtn");
        if (!btn) return;

        btn.addEventListener("click", async () => {
            // Ask Flask for the previous state
            const res = await fetch("/restore_home");
            if (!res.ok) {
            alert("Server error");
            return;
            }
            const data = await res.json();

            // Replace only the product container
            const container = document.querySelector(".container");
            container.innerHTML = `
            <h4 class="mb-3 text-success">
                Best Matches for <span class="text-warning fw-bold">"${data.query}"</span>
            </h4>
            <div class="row row-cols-1 row-cols-md-3 g-4">
                ${data.recommendations.map(item => `
                <div class="col">
                    <div class="card h-100">
                    <img src="${item['Image URL'] || ''}" class="product-img" alt="">
                    <div class="card-body d-flex flex-column">
                        <h5 class="card-title">${item['Title']}</h5>
                        <p class="card-text mb-1"><strong>Price:</strong> ₹${item['Price (INR)']}</p>
                        <a href="/product/${item['idx']}" class="btn amazon-btn mt-auto">Details</a>
                        <a href="${item['Product Link']}" target="_blank" 
                        class="btn btn-outline-warning mt-2">Open on Amazon</a>
                    </div>
                    </div>
                </div>`).join("")}
            </div>`;
        });
        });
        </script>

</body>
</html>
